I"õ<h2 id="å®‰è£…">å®‰è£…</h2>

<p><strong>brewå®‰è£…Mysql</strong></p>

<pre><code class="language-no">lihan@LideMacBook-Air ~ % brew install mysql
==&gt; Installing mysql
==&gt; Summary
ğŸº  /opt/homebrew/Cellar/mysql/8.0.26: 303 files, 296.7MB
==&gt; mysql
We've installed your MySQL database without a root password. To secure it run:
    mysql_secure_installation

MySQL is configured to only allow connections from localhost by default

To connect run:
    mysql -uroot

To have launchd start mysql now and restart at login:
  brew services start mysql
Or, if you don't want/need a background service you can just run:
  mysql.server start
lihan@LideMacBook-Air ~ % mysql.server start
Starting MySQL
.. SUCCESS! 
lihan@LideMacBook-Air ~ % mysql_secure_installation

Securing the MySQL server deployment.

Connecting to MySQL using a blank password.

VALIDATE PASSWORD COMPONENT can be used to test passwords
and improve security. It checks the strength of password
and allows the users to set only those passwords which are
secure enough. Would you like to setup VALIDATE PASSWORD component?

Press y|Y for Yes, any other key for No: y

There are three levels of password validation policy:

LOW    Length &gt;= 8
MEDIUM Length &gt;= 8, numeric, mixed case, and special characters
STRONG Length &gt;= 8, numeric, mixed case, special characters and dictionary                  file

Please enter 0 = LOW, 1 = MEDIUM and 2 = STRONG: 2
Please set the password for root here.

New password: 

Re-enter new password: 

Estimated strength of the password: 100 
Do you wish to continue with the password provided?(Press y|Y for Yes, any other key for No) : y
By default, a MySQL installation has an anonymous user,
allowing anyone to log into MySQL without having to have
a user account created for them. This is intended only for
testing, and to make the installation go a bit smoother.
You should remove them before moving into a production
environment.

Remove anonymous users? (Press y|Y for Yes, any other key for No) : y
Success.


Normally, root should only be allowed to connect from
'localhost'. This ensures that someone cannot guess at
the root password from the network.

Disallow root login remotely? (Press y|Y for Yes, any other key for No)  n    
 ... skipping.
By default, MySQL comes with a database named 'test' that
anyone can access. This is also intended only for testing,
and should be removed before moving into a production
environment.


Remove test database and access to it? (Press y|Y for Yes, any other key for No) : y
 - Dropping test database...
Success.

 - Removing privileges on test database...
Success.

Reloading the privilege tables will ensure that all changes
made so far will take effect immediately.

Reload privilege tables now? (Press y|Y for Yes, any other key for No) : y
Success.

All done! 
lihan@LideMacBook-Air ~ % mysql -u root -p
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 11
Server version: 8.0.26 Homebrew

Copyright (c) 2000, 2021, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt; exit;
Bye
</code></pre>

<p><strong>å»ºç«‹æ•°æ®åº“</strong></p>

<pre><code class="language-no">é“¾æ¥ï¼šhttps://pan.baidu.com/s/1xDsDWFLiRITYTT6HoFb7Tw 
æå–ç ï¼šs5iz
</code></pre>

<p>æ³¨æ„å­˜æ”¾ä½ç½®å¦‚æœæœ‰ä¸­æ–‡è·¯å¾„å¯èƒ½ä¼šåœ¨ä¹‹åæŠ¥<code class="language-plaintext highlighter-rouge">error 2</code>é”™è¯¯</p>

<p>åœ¨<code class="language-plaintext highlighter-rouge">source</code>åç›´æ¥æ‹–å…¥<code class="language-plaintext highlighter-rouge">sql</code>æ–‡ä»¶å³å¯</p>

<pre><code class="language-no">mysql&gt; create database mydatabase;
Query OK, 1 row affected (0.01 sec)

mysql&gt; use mydatabase
Database changed
mysql&gt; source /Users/lihan/Desktop/summer/create-databases.sql 
Query OK, 0 rows affected, 1 warning (0.00 sec)
....
mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mydatabase         |
| mysql              |
| performance_schema |
| sql_hr             |
| sql_inventory      |
| sql_invoicing      |
| sql_store          |
| sys                |
+--------------------+
9 rows in set (0.00 sec)

mysql&gt; drop database mydatabase;
Query OK, 0 rows affected (0.01 sec)
</code></pre>

<h2 id="å•è¡¨æ£€ç´¢">å•è¡¨æ£€ç´¢</h2>

<ul>
  <li>Mysqlå¤§å°å†™ä¸åˆ†ï¼Œå»ºè®®å¤§å†™å…³é”®å­—ï¼Œå°å†™å…¶ä»–å†…å®¹</li>
  <li>åœ¨è¡Œå‰ä½¿ç”¨<code class="language-plaintext highlighter-rouge">--</code>è¡¨ç¤ºæ³¨é‡Š</li>
  <li>æ¯ä¸ªè¯­å¥åä½¿ç”¨<code class="language-plaintext highlighter-rouge">;</code>è¡¨ç¤ºç»“æŸ</li>
  <li>å¯ä»¥ä½¿ç”¨ç®—æœ¯è¡¨è¾¾å¼</li>
  <li>å¯ä»¥ä½¿ç”¨<code class="language-plaintext highlighter-rouge">AS</code>å…³é”®å­—ä¸ºåˆ—å–åˆ«å</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">first_name</span><span class="p">,</span> <span class="n">point</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">100</span> <span class="k">AS</span> <span class="nv">`discount_factor`</span>
<span class="k">FROM</span> <span class="n">customers</span>
<span class="c1">-- WHERE custom_id = 1</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">first_name</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>` DISTINCT<code class="language-plaintext highlighter-rouge">å¯ä»¥åˆ é™¤é‡å¤é¡¹ï¼Œ *é‡å¤*æ˜¯ä»¥åˆ—çš„ç»„åˆåˆ¤æ–­çš„ï¼Œ</code>DISTINCT`å¿…é¡»æ”¾åœ¨å¼€å¤´</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="k">state</span> 
<span class="k">FROM</span> <span class="n">customers</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">WHERE</code>ä¸­å¯¹äºæ–‡æœ¬éœ€è¦ä½¿ç”¨å•å¼•å·æˆ–åŒå¼•å·ï¼Œæ–‡æœ¬å¤§å°å†™ä¸æ•æ„Ÿ</li>
  <li>æ³¨æ„æ­¤å¤„çš„<code class="language-plaintext highlighter-rouge">Customers</code>ä¸<code class="language-plaintext highlighter-rouge">va</code>å‡å¤§å°å†™ä¸æ•æ„Ÿ</li>
  <li><code class="language-plaintext highlighter-rouge">!=</code> ï¼Œ<code class="language-plaintext highlighter-rouge">&lt;&gt;</code>å‡æ„ä¸ºä¸ç­‰äº</li>
  <li>æ—¥æœŸç±»å‹æ•°æ®ä¹Ÿéœ€ä½¿ç”¨å¼•å·</li>
  <li>å¯ä»¥ä½¿ç”¨<code class="language-plaintext highlighter-rouge">AND</code>ï¼Œ<code class="language-plaintext highlighter-rouge">OR</code>ï¼Œ<code class="language-plaintext highlighter-rouge">NOT</code>åˆ›å»ºå¤åˆæ¡ä»¶è¯­å¥</li>
  <li>æ¡ä»¶è¯­å¥ä¸­å¯ä»¥ä½¿ç”¨ç®—æ•°è¡¨è¾¾å¼</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">Customers</span>
<span class="k">WHERE</span> <span class="k">state</span> <span class="o">&lt;&gt;</span> <span class="s1">'va'</span> 
			<span class="k">AND</span> <span class="n">birth_data</span> <span class="o">&gt;</span> <span class="s1">'1990-01-01'</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">IN</code>å…³é”®å­—åˆ¤æ–­æ˜¯å¦åœ¨é›†åˆä¸­</li>
  <li><code class="language-plaintext highlighter-rouge">BETWEEN</code>å…³é”®å­—åˆ¤æ–­æ˜¯å¦åœ¨é—­åŒºé—´å†…</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">customers</span>
<span class="k">WHERE</span> <span class="k">state</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'VA'</span><span class="p">,</span> <span class="s1">'FL'</span><span class="p">)</span> 
			<span class="k">AND</span> <span class="n">points</span> <span class="k">BETWEEN</span> <span class="mi">1000</span> <span class="k">AND</span> <span class="mi">2000</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">LIKE</code>å…³é”®å­—ç”¨äºæ–‡æœ¬æ¨¡ç³ŠåŒ¹é…å¸¸ç”¨çš„æœ‰ï¼š<code class="language-plaintext highlighter-rouge">_</code>å•ä¸€å­—ç¬¦ï¼Œ<code class="language-plaintext highlighter-rouge">%</code>ä»»æ„æ•°ç›®å­—ç¬¦</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">customers</span>
<span class="k">WHERE</span> <span class="n">last_name</span> <span class="k">LIKE</span> <span class="s1">'%field%'</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">REGEXP</code>å…³é”®å­—ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œæ¨¡ç³ŠåŒ¹é…</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">customers</span>
<span class="k">WHERE</span> <span class="n">last_name</span> <span class="n">REGEXP</span> <span class="s1">'field'</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">NULL</code>è¡¨ç¤ºç©ºå€¼</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">customers</span>
<span class="k">WHERE</span> <span class="n">phone</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ç»“æœé›†é»˜è®¤ä»¥ä¸»é”®ä¸ºæ ‡å‡†è¿›è¡Œç”Ÿåºæ’åºï¼Œä½¿ç”¨<code class="language-plaintext highlighter-rouge">ORDER BY</code>å…³é”®å­—å¯ä»¥ä½¿ç”¨å…¶ä»–åˆ—ä¸ºæ ‡å‡†æ’åº</li>
  <li>é»˜è®¤å‡åºæ’åºï¼Œä½¿ç”¨<code class="language-plaintext highlighter-rouge">DESC</code>è¿›è¡Œé™åºæ’åº</li>
  <li>å¯ä»¥ä½¿ç”¨å¤šä¸ªæ’åºè§„åˆ™ï¼Œè¶Šé å‰ä¼˜å…ˆçº§è¶Šé«˜</li>
  <li>Mysqlä¸­å…è®¸ç”¨äºæ’åºçš„åˆ—ä¸æ˜¯ç»“æœé›†çš„åˆ—</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">first_name</span>
<span class="k">FROM</span> <span class="n">customers</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">state</span> <span class="k">DESC</span><span class="p">,</span> <span class="n">first_name</span> <span class="k">DESC</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">LIMIT</code>å…³é”®å­—ç”¨äºé™åˆ¶ç»“æœé›†å¤§å°ï¼Œå¯ç”¨äºç½‘ç«™åˆ†é¡µ</li>
  <li><code class="language-plaintext highlighter-rouge">LIMIT 3</code>ä»£è¡¨ç»“æœé›†å¤§å°ä¸º3ï¼Œ<code class="language-plaintext highlighter-rouge">LIMIT 6, 3</code>ä»£è¡¨è·³è¿‡6è¡Œå–3è¡Œ</li>
  <li>æ³¨æ„<code class="language-plaintext highlighter-rouge">WHERE</code>ï¼Œ<code class="language-plaintext highlighter-rouge">ORDER BY</code>ï¼Œ<code class="language-plaintext highlighter-rouge">LIMIT</code>åœ¨è¯­å¥ä¸­å‡ºç°çš„å…ˆåé¡ºåº</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">customers</span>
<span class="k">WHERE</span> <span class="k">state</span> <span class="o">&lt;&gt;</span> <span class="s1">'va'</span> 
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">points</span> <span class="k">DESC</span>
<span class="k">LIMIT</span> <span class="mi">3</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="å¤šè¡¨æ£€ç´¢">å¤šè¡¨æ£€ç´¢</h2>

<ul>
  <li><code class="language-plaintext highlighter-rouge">JOIN</code>é»˜è®¤ä»£è¡¨å†…è¿æ¥å³ <code class="language-plaintext highlighter-rouge">INNER JOIN</code></li>
  <li>å¯ä»¥ä¸ºè¡¨å–åˆ«å</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">o</span><span class="p">.</span><span class="n">customer_id</span>
<span class="k">FROM</span> <span class="n">orders</span> <span class="n">o</span>
<span class="k">JOIN</span> <span class="n">customers</span>
		 <span class="k">ON</span> <span class="n">o</span><span class="p">.</span><span class="n">customer_id</span> <span class="o">=</span> <span class="n">customer</span><span class="p">.</span><span class="n">customer_id</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>å¯ä»¥å¯¹ä¸åŒæ•°æ®åº“çš„è¡¨è¿›è¡Œè¿æ¥</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">order_items</span> <span class="n">oi</span>
<span class="k">JOIN</span> <span class="n">sql_inventory</span><span class="p">.</span><span class="n">products</span> <span class="n">p</span>
		 <span class="k">ON</span> <span class="n">oi</span><span class="p">.</span><span class="n">product_id</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">product_id</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>è¡¨ä¹Ÿå¯ä»¥ä¸è‡ªèº«è¿›è¡Œè¿æ¥ï¼Œç§°ä¸ºè‡ªè¿æ¥</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">e</span><span class="p">.</span><span class="n">employee_id</span><span class="p">,</span>
			 <span class="n">e</span><span class="p">.</span><span class="n">first_name</span><span class="p">,</span>
			 <span class="n">m</span><span class="p">.</span><span class="n">first_nam</span>
<span class="k">FROM</span> <span class="n">employees</span> <span class="n">e</span>
<span class="k">JOIN</span> <span class="n">employees</span> <span class="n">m</span>
		 <span class="k">WHERE</span> <span class="n">e</span><span class="p">.</span><span class="n">reports_to</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">employee_id</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">JOIN</code>å¤šæ¬¡ä½¿ç”¨å¯ä»¥å¤šè¡¨è¿æ¥</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">orders</span> <span class="n">o</span>
<span class="k">JOIN</span> <span class="n">customers</span> <span class="k">c</span>
<span class="k">ON</span> <span class="n">o</span><span class="p">.</span><span class="n">customer_id</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">customer_id</span>
<span class="k">JOIN</span> <span class="n">order_statuses</span> <span class="n">os</span>
<span class="k">ON</span> <span class="n">o</span><span class="p">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">order_status_id</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>Â <code class="language-plaintext highlighter-rouge">AND</code>åˆ›å»ºå¤åˆè¿æ¥æ¡ä»¶</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">order_items</span> <span class="n">oi</span>
<span class="k">JOIN</span> <span class="n">order_items_notes</span> <span class="n">oin</span>
		<span class="k">ON</span> <span class="n">oi</span><span class="p">.</span><span class="n">order_id</span> <span class="o">=</span> <span class="n">oin</span><span class="p">.</span><span class="n">order_id</span>
		<span class="k">AND</span> <span class="n">oi</span><span class="p">.</span><span class="n">product_id</span> <span class="o">=</span> <span class="n">oin</span><span class="p">.</span><span class="n">product_id</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ä¸€èˆ¬æˆ‘ä»¬ä½¿ç”¨æ˜¾å¼è¿æ¥ï¼ˆç¬¬ä¸€å¥ï¼‰è€Œä¸æ˜¯éšå¼è¿æ¥ï¼ˆç¬¬äºŒå¥ï¼‰</li>
  <li>æ˜¾å¼è¿æ¥ä¸åŠ <code class="language-plaintext highlighter-rouge">ON</code>æŒ‡åè¿æ¥æ¡ä»¶æˆ–éšå¼è¿æ¥ä¸åŠ <code class="language-plaintext highlighter-rouge">WHERE</code>ï¼Œçš„æ—¶å€™ç§°ä¸ºäº¤å‰è¿æ¥ï¼Œè¿”å›ç¬›å¡å°”ç§¯çš„ç»“æœ</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">orders</span> <span class="n">o</span>
<span class="k">JOIN</span> <span class="n">customers</span> <span class="k">c</span>
		<span class="k">ON</span> <span class="n">o</span><span class="p">.</span><span class="n">customer_id</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">customer_id</span><span class="p">;</span>
		
<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">orders</span> <span class="n">o</span><span class="p">,</span> <span class="n">customers</span> <span class="k">c</span>
<span class="k">WHERE</span> <span class="n">o</span><span class="p">.</span><span class="n">customer_id</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">customer_id</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">orders</span> <span class="n">o</span><span class="p">,</span> <span class="n">customers</span> <span class="k">c</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">LEFT JOIN</code>å·¦å¤–è¿æ¥è¡¨ç¤ºæ‰€æœ‰å·¦è¡¨çš„è®°å½•éƒ½ä¼šè¿”å›ï¼Œå¦‚æœå³è¡¨æ²¡æœ‰ç›¸åŒ¹é…çš„ç»“æœï¼Œå¯¹åº”ä½ç½®ç½®ä¸ºNULL</li>
  <li><code class="language-plaintext highlighter-rouge">OUTER</code>å…³é”®å­—ä¸€èˆ¬çœå»</li>
  <li>ä¸ºä½¿å¾—è¯­å¥æ¸…æ™°ï¼Œå¤–è¿æ¥å°½é‡ä½¿ç”¨å·¦è¿æ¥</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">customers</span> <span class="k">c</span>
<span class="k">LEFT</span> <span class="k">OUTER</span> <span class="k">JOIN</span> <span class="n">orders</span> <span class="n">o</span>
		<span class="k">ON</span> <span class="k">c</span><span class="p">.</span><span class="n">customer_id</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="n">customer_id</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>å¤šè¡¨è¿æ¥æ—¶å€™ï¼Œåˆ¤æ–­å·¦å³è¡¨å…³ç³»ä¼¼ä¹æ˜¯æŒ‰ç…§<code class="language-plaintext highlighter-rouge">ON</code>æ¥çš„ï¼Œæœ‰å¾…è¡¥å……</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">customers</span> <span class="k">c</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">orders</span> <span class="n">o</span>
		<span class="k">ON</span> <span class="k">c</span><span class="p">.</span><span class="n">customer_id</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="n">customer_id</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">shippers</span> <span class="n">sh</span>
		<span class="k">ON</span> <span class="n">o</span><span class="p">.</span><span class="n">shipper_id</span> <span class="o">=</span> <span class="n">sh</span><span class="p">.</span><span class="n">shipper_id</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">c</span><span class="p">.</span><span class="n">customer_id</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>å’Œå†…è¿æ¥ç±»ä¼¼ï¼Œå¤–è¿æ¥ä¹Ÿå¯ä»¥è‡ªè¿æ¥</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">employees</span> <span class="n">m</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">emplyees</span> <span class="n">m</span>
		<span class="k">ON</span> <span class="n">e</span><span class="p">.</span><span class="n">reports_to</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">emplyee_id</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>å½“ä¸¤ä¸ªè¡¨çš„åˆ—åå®Œå…¨ä¸€æ ·æ—¶ï¼Œä½¿ç”¨<code class="language-plaintext highlighter-rouge">USING</code>ç®€åŒ–ï¼Œ<code class="language-plaintext highlighter-rouge">USING</code>åŒæ ·é€‚ç”¨äºæœ‰å¤šä¸ªåˆ—ä½œä¸ºé”®ç çš„æƒ…å†µ</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">orders</span> <span class="n">o</span>
<span class="k">JOIN</span> <span class="n">customers</span> <span class="k">c</span>
		<span class="c1">-- ON o.customer_id = c.customer_id</span>
		<span class="k">USING</span> <span class="p">(</span><span class="n">customer_id</span><span class="p">);</span>

<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">order_items</span> <span class="n">oi</span>
<span class="k">JOIN</span> <span class="n">order_items_notes</span> <span class="n">oin</span>
		<span class="c1">-- ON oi.order_id = oin.order_id</span>
		<span class="c1">-- AND oi.product_id = oin.product_id;</span>
		<span class="k">USING</span> <span class="p">(</span><span class="n">order_id</span><span class="p">,</span> <span class="n">product_id</span><span class="p">);</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">NATURAL JOIN</code>è‡ªç„¶è¿æ¥ï¼Œä½¿ç”¨åŒåçš„å±æ€§ç»„ï¼Œå¹¶ä¸”åœ¨ç»“æœä¸­æŠŠé‡å¤çš„å±æ€§åˆ—å»æ‰ï¼Œä¸å»ºè®®ä½¿ç”¨</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">orders</span> <span class="n">o</span>
<span class="k">NATURAL</span> <span class="k">JOIN</span> <span class="n">customers</span> <span class="k">c</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">CROSS JOIN</code>äº¤å‰è¿æ¥ï¼Œè¿”å›ç¬›å¡å°”ç§¯ï¼Œå³æ‰€æœ‰çš„ç»„åˆç»“æœ</li>
  <li>ç¬¬ä¸€å¥ä¸ºæ˜¾å¼å†™æ³•ï¼Œç¬¬äºŒå¥ä¸ºéšå¼å†™æ³•</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">orders</span> <span class="n">o</span>
<span class="k">CROSS</span> <span class="k">JOIN</span> <span class="n">customers</span> <span class="k">c</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">orders</span> <span class="n">o</span><span class="p">,</span> <span class="n">customers</span> <span class="k">c</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">UNION</code>è”åˆæŸ¥è¯¢ç»“æœï¼Œä¸¤æ¬¡<code class="language-plaintext highlighter-rouge">SELECT</code>å¿…é¡»æœ‰ç›¸åŒçš„å±æ€§æ•°ï¼Œå±æ€§åä»¥ç¬¬ä¸€æ¬¡æŸ¥è¯¢ä¸ºä¸»è¿›è¡Œæ•´åˆ</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">first_name</span>
<span class="k">FROM</span> <span class="n">archived_orders</span>
<span class="k">UNION</span>
<span class="k">SELECT</span> <span class="n">name</span>
<span class="k">FROM</span> <span class="n">orders</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="æ’å…¥æ›´æ–°åˆ é™¤">æ’å…¥ã€æ›´æ–°ã€åˆ é™¤</h2>

<ul>
  <li><code class="language-plaintext highlighter-rouge">INSERT INTO</code>æ’å…¥å•è¡Œ</li>
  <li><code class="language-plaintext highlighter-rouge">DEFAULT</code>å¯ç”¨äºå­˜åœ¨é»˜è®¤å€¼æˆ–é€’å¢çš„å±æ€§</li>
  <li><code class="language-plaintext highlighter-rouge">NULL</code>å¯ç”¨äºå…è®¸ç©ºå€¼çš„å±æ€§</li>
  <li>å¯ä»¥æŒ‡å®šè¦æ’å…¥çš„åˆ—</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">customers</span>
<span class="k">VALUES</span> <span class="p">(</span>
  	<span class="k">DEFAULT</span><span class="p">,</span> 
  	<span class="s1">'John'</span><span class="p">,</span> 
  	<span class="s1">'Smith'</span><span class="p">,</span> 
  	<span class="k">NULL</span><span class="p">,</span>
		<span class="s1">'address'</span><span class="p">,</span>
		<span class="s1">'city'</span><span class="p">,</span>
		<span class="s1">'CA'</span><span class="p">,</span>
		<span class="mi">200</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">customers</span> <span class="p">(</span>
		<span class="n">first_name</span><span class="p">,</span>
		<span class="n">last_name</span><span class="p">,</span>
		<span class="n">birth_date</span><span class="p">,</span>
		<span class="n">address</span><span class="p">,</span>
		<span class="n">city</span><span class="p">,</span>
		<span class="k">state</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span>
  	<span class="s1">'John'</span><span class="p">,</span> 
  	<span class="s1">'Smith'</span><span class="p">,</span> 
  	<span class="s1">'1990-01-01'</span><span class="p">,</span>
		<span class="s1">'address'</span><span class="p">,</span>
		<span class="s1">'city'</span><span class="p">,</span>
		<span class="s1">'CA'</span><span class="p">);</span>
</code></pre></div></div>

<ul>
  <li>ä½¿ç”¨<code class="language-plaintext highlighter-rouge">VALUES</code>ä¹Ÿå¯ä»¥ä¸€æ¬¡æ’å…¥å¤šè¡Œ</li>
  <li>åœ¨åˆ é™¤ä¸€äº›è¡Œçš„æƒ…å†µä¸‹ï¼Œè‡ªå¢çš„å±æ€§å€¼ä¾ç„¶ä¼šè®°ä½ä»–ä»¬ï¼Œå³å‡ºç°é€’å¢å±æ€§ä¸è¿ç»­</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">shippers</span> <span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="s1">'Shipper1'</span><span class="p">),</span>
			 <span class="p">(</span><span class="s1">'Shipper2'</span><span class="p">),</span>
			 <span class="p">(</span><span class="s1">'Shipper3'</span><span class="p">);</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">LAST_INSERT_TO()</code>è·å¾—æœ€æ–°æ‰§è¡ŒæˆåŠŸçš„<code class="language-plaintext highlighter-rouge">INSERT</code>è¯­å¥çš„è‡ªå¢id</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">orders</span> <span class="p">(</span><span class="n">customer_id</span><span class="p">,</span> <span class="n">order_date</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'2019-01-01'</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">order_items</span>
<span class="k">VALUES</span> 
    <span class="p">(</span><span class="n">last_insert_id</span><span class="p">(),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">.</span><span class="mi">5</span><span class="p">),</span>
    <span class="p">(</span><span class="n">last_insert_id</span><span class="p">(),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">5</span><span class="p">);</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">CREATE TABLE</code>å¯ä»¥é€šè¿‡<code class="language-plaintext highlighter-rouge">SELECT</code>è¯­å¥åˆ›å»ºåŸºäºæŸ¥è¯¢çš„å¤åˆ¶è¡¨ï¼Œå±æ€§ä¸å†æ‹¥æœ‰è‡ªå¢ï¼Œä¸»é”®ç­‰æ€§è´¨</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">orders_archived</span> <span class="k">AS</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">orders</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">UPDATE</code>å…³é”®å­—å¯ç”¨äºæ›´æ–°è¡¨ä¸­çš„æŸäº›è¡Œ</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="n">invoices</span>
<span class="k">SET</span> <span class="n">payment_total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">invoice_total</span><span class="p">,</span> 
    <span class="n">payment_date</span> <span class="o">=</span> <span class="s1">'2019-01-01'</span>
<span class="k">WHERE</span> <span class="n">invoice_id</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">UPDATE</code>æ“ä½œä¹Ÿå¯ä»¥ç»“åˆå­æŸ¥è¯¢ä½¿ç”¨</li>
  <li>å­æŸ¥è¯¢æ·»åŠ æ‹¬å·ç¡®ä¿å…ˆæ‰§è¡Œ</li>
  <li>å­æŸ¥è¯¢è¿”å›å¤šä¸ªæ•°æ®æ—¶åº”ä½¿ç”¨<code class="language-plaintext highlighter-rouge">IN</code>å…³é”®å­—</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="n">invoices</span>
<span class="k">SET</span> <span class="n">payment_total</span> <span class="o">=</span> <span class="mi">567</span><span class="p">,</span> 
		<span class="n">payment_date</span> <span class="o">=</span> <span class="n">due_date</span>
<span class="k">WHERE</span> <span class="n">client_id</span> <span class="o">=</span> 
            <span class="p">(</span><span class="k">SELECT</span> <span class="n">client_id</span> 
            <span class="k">FROM</span> <span class="n">clients</span>
            <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'Yadel'</span><span class="p">);</span>

<span class="k">UPDATE</span> <span class="n">invoices</span>
<span class="k">SET</span> <span class="n">payment_total</span> <span class="o">=</span> <span class="mi">567</span><span class="p">,</span> 
		<span class="n">payment_date</span> <span class="o">=</span> <span class="n">due_date</span>
<span class="k">WHERE</span> <span class="n">client_id</span> <span class="k">IN</span> 
            <span class="p">(</span><span class="k">SELECT</span> <span class="n">client_id</span> 
            <span class="k">FROM</span> <span class="n">clients</span>
            <span class="k">WHERE</span> <span class="k">state</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">'CA'</span><span class="p">,</span> <span class="s1">'NY'</span><span class="p">));</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">DELETE</code>å…³é”®å­—ç”¨äºåˆ é™¤</li>
  <li><code class="language-plaintext highlighter-rouge">WHERE</code>å¯é€‰ï¼Œçœç•¥å°†åˆ é™¤è¡¨çš„æ‰€æœ‰è®°å½•</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">invoices</span>
<span class="k">WHERE</span> <span class="n">client_id</span> <span class="o">=</span> 
            <span class="p">(</span><span class="k">SELECT</span> <span class="n">client_id</span>  
            <span class="k">FROM</span> <span class="n">clients</span>
            <span class="k">WHERE</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">'Myworks'</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="æ±‡æ€»æ•°æ®">æ±‡æ€»æ•°æ®</h2>

<ul>
  <li>Mysqlå†…ç½®æœ‰<code class="language-plaintext highlighter-rouge">MAX()</code>ï¼Œ<code class="language-plaintext highlighter-rouge">MIN()</code>ï¼Œ<code class="language-plaintext highlighter-rouge">AVG()</code>ï¼Œ<code class="language-plaintext highlighter-rouge">SUM()</code>ï¼Œ<code class="language-plaintext highlighter-rouge">COUNT()</code>ç­‰èšåˆå‡½æ•°</li>
  <li>èšåˆå‡½æ•°ä¸ä»…å¯ä»¥ç”¨äºåˆ—ï¼Œä¹Ÿå¯ä»¥ç”¨äºè¡¨è¾¾å¼</li>
  <li>èšåˆå‡½æ•°ä¼šå¿½ç•¥ç©ºå€¼ï¼Œå¯¹äº<code class="language-plaintext highlighter-rouge">COUNT()</code>å‡½æ•°éœ€è¦æ³¨æ„</li>
  <li><code class="language-plaintext highlighter-rouge">COUNT(*) </code>ä¸ä¼šå¿½ç•¥ç©ºå€¼ï¼Œ<code class="language-plaintext highlighter-rouge">*</code>è¡¨ç¤ºå…¨éƒ¨æ•°æ®</li>
  <li>å¯ä»¥ä½¿ç”¨<code class="language-plaintext highlighter-rouge">DISTINCT</code>ç­›æ‰åˆ—çš„é‡å¤å€¼</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> 
    <span class="k">MAX</span><span class="p">(</span><span class="n">invoice_date</span><span class="p">)</span> <span class="k">AS</span> <span class="n">latest_date</span><span class="p">,</span>  
    <span class="k">MIN</span><span class="p">(</span><span class="n">invoice_total</span><span class="p">)</span> <span class="n">lowest</span><span class="p">,</span>
    <span class="k">AVG</span><span class="p">(</span><span class="n">invoice_total</span><span class="p">)</span> <span class="n">average</span><span class="p">,</span>
    <span class="k">SUM</span><span class="p">(</span><span class="n">invoice_total</span> <span class="o">*</span> <span class="mi">1</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="n">total</span><span class="p">,</span>
    <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">total_records</span><span class="p">,</span>
    <span class="k">COUNT</span><span class="p">(</span><span class="n">invoice_total</span><span class="p">)</span> <span class="n">number_of_invoices</span><span class="p">,</span> 
    <span class="k">COUNT</span><span class="p">(</span><span class="n">payment_date</span><span class="p">)</span> <span class="n">number_of_payments</span><span class="p">,</span>  
    <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">client_id</span><span class="p">)</span> <span class="n">number_of_distinct_clients</span>
<span class="k">FROM</span> <span class="n">invoices</span>
<span class="k">WHERE</span> <span class="n">invoice_date</span> <span class="o">&gt;</span> <span class="s1">'2019-07-01'</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">GROUP BY</code>é…åˆèšåˆå‡½æ•°ä½¿ç”¨ï¼Œè¿›è¡Œåˆ†ç»„ç»Ÿè®¡</li>
  <li>æ³¨æ„<code class="language-plaintext highlighter-rouge">WHERE</code>ï¼Œ<code class="language-plaintext highlighter-rouge">GROUP BY</code>ï¼Œ<code class="language-plaintext highlighter-rouge">ORDER BY</code>çš„å…ˆåé¡ºåº</li>
  <li><code class="language-plaintext highlighter-rouge">GROUP BY</code>ä¹Ÿå¯ä»¥å¤šåˆ—ç»„åˆä¸ºä¾æ®åˆ†ç»„ï¼Œé€—å·åˆ†éš”å³å¯</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> 
    <span class="n">client_id</span><span class="p">,</span>  
    <span class="k">SUM</span><span class="p">(</span><span class="n">invoice_total</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_sales</span>
<span class="k">FROM</span> <span class="n">invoices</span>
<span class="k">WHERE</span> <span class="n">invoice_date</span> <span class="o">&gt;=</span> <span class="s1">'2019-07-01'</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">client_id</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">total_sales</span> <span class="k">DESC</span><span class="p">;</span>

<span class="k">SELECT</span> 
    <span class="k">state</span><span class="p">,</span>
    <span class="n">city</span><span class="p">,</span>
    <span class="k">SUM</span><span class="p">(</span><span class="n">invoice_total</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_sales</span>
<span class="k">FROM</span> <span class="n">invoices</span>
<span class="k">JOIN</span> <span class="n">clients</span> <span class="k">USING</span> <span class="p">(</span><span class="n">client_id</span><span class="p">)</span> 
<span class="k">GROUP</span> <span class="k">BY</span> <span class="k">state</span><span class="p">,</span> <span class="n">city</span>  
<span class="k">ORDER</span> <span class="k">BY</span> <span class="k">state</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">HAVING</code>å…³é”®å­—å¯¹<code class="language-plaintext highlighter-rouge">SELECT</code>åçš„ç»“æœåˆ—è¿›è¡Œäº‹åç­›é€‰ï¼Œé€šå¸¸ç”¨äºåˆ†ç»„èšåˆåæŸ¥è¯¢</li>
  <li><code class="language-plaintext highlighter-rouge">HAVING</code>å’Œ <code class="language-plaintext highlighter-rouge">WHERE</code> éƒ½æ˜¯æ˜¯æ¡ä»¶ç­›é€‰è¯­å¥ï¼Œæ¡ä»¶å†™æ³•ç›¸é€š</li>
  <li><code class="language-plaintext highlighter-rouge">HAVING</code>ä½¿ç”¨ç»“æœåˆ—æ˜ï¼Œ<code class="language-plaintext highlighter-rouge">WHERE</code>ä½¿ç”¨åŸè¡¨åˆ—å</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> 
    <span class="n">client_id</span><span class="p">,</span>
    <span class="k">SUM</span><span class="p">(</span><span class="n">invoice_total</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_sales</span><span class="p">,</span>
    <span class="k">COUNT</span><span class="p">(</span><span class="o">*/</span><span class="n">invoice_total</span><span class="o">/</span><span class="n">invoice_date</span><span class="p">)</span> <span class="k">AS</span> <span class="n">number_of_invoices</span>
<span class="k">FROM</span> <span class="n">invoices</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">client_id</span>
<span class="k">HAVING</span> <span class="n">total_sales</span> <span class="o">&gt;</span> <span class="mi">500</span> <span class="k">AND</span> <span class="n">number_of_invoices</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>Mysqlæä¾›äº†<code class="language-plaintext highlighter-rouge">ROLLUP</code>è¿ç®—ç¬¦å¯¹èšåˆå€¼è¿›è¡Œæ±‡æ€»ï¼Œå¦‚ä¸‹å°†è¿”å›å„å®¢æˆ·çš„å‘ç¥¨æ€»é¢ä»¥åŠæ‰€æœ‰äººçš„æ€»å‘ç¥¨é¢</li>
  <li><code class="language-plaintext highlighter-rouge">ROLLUP</code>ä¸æ˜¯æ ‡å‡†çš„SQLè¯­è¨€</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> 
    <span class="n">client_id</span><span class="p">,</span>
    <span class="k">SUM</span><span class="p">(</span><span class="n">invoice_total</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">invoices</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">client_id</span> <span class="k">WITH</span> <span class="k">ROLLUP</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>å½“<code class="language-plaintext highlighter-rouge">GROUP BY</code>å–å¤šåˆ—æ—¶ï¼Œ<code class="language-plaintext highlighter-rouge">ROLLUP</code>å¯ä»¥è¿›è¡Œå¤šå±‚æ±‡æ€»</li>
  <li>ä¸‹é¢å°†è¿”å›å„å·çš„å„å¸‚çš„å‘ç¥¨æ€»é¢ä»¥åŠå·å±‚æ¬¡å’Œå…¨å›½å±‚æ¬¡çš„æ±‡æ€»é¢</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> 
    <span class="k">state</span><span class="p">,</span>
    <span class="n">city</span><span class="p">,</span>
    <span class="k">SUM</span><span class="p">(</span><span class="n">invoice_total</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_sales</span>
<span class="k">FROM</span> <span class="n">invoices</span>
<span class="k">JOIN</span> <span class="n">clients</span> <span class="k">USING</span> <span class="p">(</span><span class="n">client_id</span><span class="p">)</span> 
<span class="k">GROUP</span> <span class="k">BY</span> <span class="k">state</span><span class="p">,</span> <span class="n">city</span> <span class="k">WITH</span> <span class="k">ROLLUP</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ä½¿ç”¨<code class="language-plaintext highlighter-rouge">ROLLUP</code>æ—¶ï¼Œ<code class="language-plaintext highlighter-rouge">GROUP BY</code>ä¸èƒ½ä½¿ç”¨åˆ—åˆ«å</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> 
    <span class="n">pm</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">payment_method</span><span class="p">,</span>
    <span class="k">SUM</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total</span>
<span class="k">FROM</span> <span class="n">payments</span> <span class="n">p</span>
<span class="k">JOIN</span> <span class="n">payment_methods</span> <span class="n">pm</span>
    <span class="k">ON</span> <span class="n">p</span><span class="p">.</span><span class="n">payment_method</span> <span class="o">=</span> <span class="n">pm</span><span class="p">.</span><span class="n">payment_method_id</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">pm</span><span class="p">.</span><span class="n">name</span> <span class="k">WITH</span> <span class="k">ROLLUP</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="ç¼–å†™å¤æ‚æŸ¥è¯¢">ç¼–å†™å¤æ‚æŸ¥è¯¢</h2>

<ul>
  <li>Mysqlå°†å…ˆæ‰§è¡Œæ‹¬å·å†…çš„å­æŸ¥è¯¢ï¼Œä¹‹åå°†ç»“æœè¿”å›ç»™å¤–æŸ¥è¯¢</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">products</span>
<span class="k">WHERE</span> <span class="n">unit_price</span> <span class="o">&gt;</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">unit_price</span>
    <span class="k">FROM</span> <span class="n">products</span>
    <span class="k">WHERE</span> <span class="n">product_id</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">);</span>

<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">products</span>
<span class="k">WHERE</span> <span class="n">product_id</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">product_id</span>
    <span class="k">FROM</span> <span class="n">order_items</span>
<span class="p">);</span>
</code></pre></div></div>

<ul>
  <li>å­æŸ¥è¯¢å°†ä¸€å¼ è¡¨çš„æŸ¥è¯¢ç»“æœä½œä¸ºå¦ä¸€å¼ è¡¨çš„æŸ¥è¯¢ä¾æ®å¹¶å±‚å±‚åµŒå¥—ï¼›é“¾æ¥å°†è¿™äº›è¡¨åˆå¹¶æˆä¸€ä¸ªåŒ…å«æ‰€éœ€å…¨éƒ¨ä¿¡æ¯çš„è¯¦æƒ…è¡¨å†ç›´æ¥åœ¨è¯¦æƒ…è¡¨é‡Œç­›é€‰æŸ¥è¯¢ï¼›ä¸¤ç§æ–¹æ³•ä¸€èˆ¬æ˜¯å¯äº’æ¢çš„ï¼Œå…·ä½“ç”¨å“ªä¸€ç§å–å†³äºæ•ˆç‡å’Œå¯è¯»æ€§</li>
  <li>ä¾‹ï¼šæŸ¥æ‰¾ä»æœªè®¢è´­è¿‡çš„é¡¾å®¢ï¼Œä¸‹é¢ä¸¤ç§æ–¹æ³•å‡å¯è¾¾åˆ°æ•ˆæœ</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">clients</span>
<span class="k">WHERE</span> <span class="n">client_id</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">client_id</span>
    <span class="k">FROM</span> <span class="n">invoices</span>
<span class="p">);</span>

<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">clients</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">invoices</span> <span class="k">USING</span> <span class="p">(</span><span class="n">client_id</span><span class="p">)</span>
<span class="k">WHERE</span> <span class="n">invoices_id</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>ä¾‹ï¼šé€‰å‡ºä¹°è¿‡ç”Ÿèœï¼ˆid = 3ï¼‰çš„é¡¾å®¢çš„idï¼Œå§“å’Œåï¼Œé‡‡ç”¨æ··åˆå­æŸ¥è¯¢+è¡¨è¿æ¥çš„æ–¹æ³•</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">customer_id</span><span class="p">,</span> <span class="n">first_name</span><span class="p">,</span> <span class="n">last_name</span>
<span class="k">FROM</span> <span class="n">customers</span>
<span class="k">WHERE</span> <span class="n">customer_id</span> <span class="k">IN</span> <span class="p">(</span>  
    <span class="k">SELECT</span> <span class="n">customer_id</span>
    <span class="k">FROM</span> <span class="n">orders</span>
    <span class="k">JOIN</span> <span class="n">order_items</span> <span class="k">USING</span> <span class="p">(</span><span class="n">order_id</span><span class="p">)</span>  
    <span class="k">WHERE</span> <span class="n">product_id</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">);</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ALL</code>å…³é”®å­—ä»£è¡¨é›†åˆä¸­çš„ä»»æ„è®°å½•</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">invoices</span>
<span class="k">WHERE</span> <span class="n">invoice_total</span> <span class="o">&gt;</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="k">MAX</span><span class="p">(</span><span class="n">invoice_total</span><span class="p">)</span>
    <span class="k">FROM</span> <span class="n">invoices</span>
    <span class="k">WHERE</span> <span class="n">client_id</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">);</span>

<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">invoices</span>
<span class="k">WHERE</span> <span class="n">invoice_total</span> <span class="o">&gt;</span> <span class="k">ALL</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">invoice_total</span>
    <span class="k">FROM</span> <span class="n">invoices</span>
    <span class="k">WHERE</span> <span class="n">client_id</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">);</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ANY</code>å…³é”®å­—ä»£è¡¨é›†åˆä¸­å­˜åœ¨æŸæ¡è®°å½•ï¼Œå¯ä¸<code class="language-plaintext highlighter-rouge">MIN</code>ç­‰æ•ˆ</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">invoices</span>
<span class="k">WHERE</span> <span class="n">invoice_total</span> <span class="o">&gt;</span> <span class="k">ANY</span> <span class="p">(</span>
<span class="k">SELECT</span> <span class="n">invoice_total</span>
<span class="k">FROM</span> <span class="n">invoices</span>
<span class="k">WHERE</span> <span class="n">client_id</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">);</span>

<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">invoices</span>
<span class="k">WHERE</span> <span class="n">invoice_total</span> <span class="o">&gt;</span> <span class="p">(</span>
<span class="k">SELECT</span> <span class="k">MIN</span><span class="p">(</span><span class="n">invoice_total</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">invoices</span>
<span class="k">WHERE</span> <span class="n">client_id</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">);</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">ANY</code>æŸäº›æ—¶å€™ä¹Ÿå¯ä¸<code class="language-plaintext highlighter-rouge">IN</code>ç­‰æ•ˆ</li>
  <li>ä¾‹ï¼šé€‰æ‹©è‡³å°‘æœ‰ä¸¤æ¬¡å‘ç¥¨è®°å½•çš„é¡¾å®¢</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">clients</span>
<span class="k">WHERE</span> <span class="n">client_id</span> <span class="k">IN</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="n">client_id</span>
    <span class="k">FROM</span> <span class="n">invoices</span>
    <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">client_id</span>
    <span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span>
<span class="p">);</span>

<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">clients</span>
<span class="k">WHERE</span> <span class="n">client_id</span> <span class="o">=</span> <span class="k">ANY</span> <span class="p">(</span> 
    <span class="k">SELECT</span> <span class="n">client_id</span>
    <span class="k">FROM</span> <span class="n">invoices</span>
    <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">client_id</span>
    <span class="k">HAVING</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span>
<span class="p">);</span>
</code></pre></div></div>

<ul>
  <li>åœ¨ä¸Šé¢çš„å­æŸ¥è¯¢ä¸­ï¼Œå­æŸ¥è¯¢ä¸ä¸»æŸ¥è¯¢æ— å…³ï¼Œå¯ä»¥å…ˆè¿›è¡Œå®Œå­æŸ¥è¯¢ï¼Œå†è¿›è¡Œä¸»æŸ¥è¯¢</li>
  <li>ç›¸å…³å­æŸ¥è¯¢ï¼Œå­æŸ¥è¯¢ä¸ä¸»æŸ¥è¯¢æœ‰å…³</li>
  <li>ä¾‹ï¼šè¿”å›å„éƒ¨é—¨ä¸­å·¥èµ„è¶…è¿‡è¯¥éƒ¨é—¨å¹³å‡å€¼çš„äººï¼Œå¯¹äº<code class="language-plaintext highlighter-rouge">employees e</code>ä¸­çš„æ¯æ¡è®°å½•ï¼Œéƒ½å°†æ‰§è¡Œä¸€æ¬¡å­æŸ¥è¯¢</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">employees</span> <span class="n">e</span>  <span class="c1">-- å…³é”® 1</span>
<span class="k">WHERE</span> <span class="n">salary</span> <span class="o">&gt;</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="k">AVG</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span>
    <span class="k">FROM</span> <span class="n">employees</span>
    <span class="k">WHERE</span> <span class="n">office_id</span> <span class="o">=</span> <span class="n">e</span><span class="p">.</span><span class="n">office_id</span>  <span class="c1">-- å…³é”® 2</span>
    <span class="c1">-- ã€å­æŸ¥è¯¢è¡¨å­—æ®µä¸ç”¨åŠ å‰ç¼€ï¼Œä¸»æŸ¥è¯¢è¡¨çš„å­—æ®µè¦åŠ å‰ç¼€ï¼Œä»¥æ­¤åŒºåˆ†ã€‘</span>
<span class="p">);</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">EXISTS</code>å…³é”®å­—å¦‚æœé›†åˆä¸ä¸ºç©ºè¿”å›<code class="language-plaintext highlighter-rouge">TRUE</code>ï¼Œå¦åˆ™è¿”å›<code class="language-plaintext highlighter-rouge">FALSE</code></li>
  <li><code class="language-plaintext highlighter-rouge">IN + å­æŸ¥è¯¢</code> ç­‰æ•ˆäº <code class="language-plaintext highlighter-rouge">EXIST + ç›¸å…³å­æŸ¥è¯¢</code>ï¼Œå¦‚å‰è€…å­æŸ¥è¯¢ç»“æœé›†è¿‡å¤§å ç”¨å†…å­˜ï¼Œåè€…é€æ¡éªŒè¯æ›´æœ‰æ•ˆç‡</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">clients</span>
<span class="k">WHERE</span> <span class="n">client_id</span> <span class="k">IN</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">client_id</span>
    <span class="k">FROM</span> <span class="n">invoices</span>
<span class="p">);</span>

<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">clients</span> <span class="k">c</span>
<span class="k">WHERE</span> <span class="k">EXISTS</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="o">*</span>
    <span class="c1">-- å°±è¿™ä¸ªå­æŸ¥è¯¢çš„ç›®çš„æ¥è¯´ï¼ŒSELECTçš„é€‰æ‹©ä¸å½±å“ç»“æœï¼Œ</span>
    <span class="c1">-- å› ä¸ºEXISTS()å‡½æ•°åªæ ¹æ®æ˜¯å¦ä¸ºç©ºè¿”å›ç»“æœ</span>
    <span class="k">FROM</span> <span class="n">invoices</span>
    <span class="k">WHERE</span> <span class="n">client_id</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">client_id</span>
<span class="p">);</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">EXISTS()</code>è¿”å›çš„æ˜¯ <code class="language-plaintext highlighter-rouge">TRUE/FALSE</code>ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥åŠ ä¸Š<code class="language-plaintext highlighter-rouge">NOT</code>å–å</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">products</span> 
<span class="k">WHERE</span> <span class="n">product_id</span> <span class="k">NOT</span> <span class="k">IN</span> <span class="p">(</span>
    <span class="k">FROM</span> <span class="n">order_items</span>
<span class="p">);</span>

<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">products</span> <span class="n">p</span>
<span class="k">WHERE</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="p">(</span>
    <span class="k">SELECT</span> <span class="o">*</span>
    <span class="k">FROM</span> <span class="n">order_items</span>
    <span class="k">WHERE</span> <span class="n">product_id</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">product_id</span>
<span class="p">);</span>
</code></pre></div></div>

<ul>
  <li>ä¾‹ï¼šç»å…¸é¢˜ç›®ï¼Œé€‰æ‹©æ²¡æœ‰é€‰æ‰€æœ‰è¯¾çš„å­¦ç”Ÿ</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- é€‰æ‹©æ²¡æœ‰é€‰æ‰€æœ‰è¯¾çš„å­¦ç”Ÿ</span>
<span class="c1">-- å­˜åœ¨æŸä¸€æ ·è¯¾ï¼Œè¯¥å­¦ç”Ÿæ²¡æœ‰å¯¹åº”çš„é€‰è¯¾è®°å½•</span>
<span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">stu</span> <span class="n">s</span>
<span class="k">WHERE</span> <span class="k">EXISTS</span><span class="p">(</span>
  	<span class="k">SELECT</span> <span class="o">*</span>
  	<span class="k">FROM</span> <span class="k">class</span> <span class="k">c</span>
  	<span class="k">WHERE</span> <span class="k">NOT</span> <span class="k">EXISTS</span><span class="p">(</span>
      	<span class="k">SELECT</span> <span class="o">*</span>
      	<span class="k">FROM</span> <span class="n">stu_class</span>
      	<span class="k">WHERE</span> <span class="n">stu_id</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">stu_id</span> <span class="k">AND</span> <span class="n">class_id</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">class_id</span>
    <span class="p">)</span>
<span class="p">);</span>
</code></pre></div></div>

<ul>
  <li>å­æŸ¥è¯¢æˆ–ç›¸å…³å­æŸ¥è¯¢ä¹Ÿå¯ç”¨äº<code class="language-plaintext highlighter-rouge">SELECT</code>ä¸­</li>
  <li>å¼•ç”¨åŒçº§çš„åˆ—åˆ«åï¼Œéœ€è¦ä½¿ç”¨<code class="language-plaintext highlighter-rouge">SELECT</code>ï¼Œå¼•ç”¨åŒçº§çš„åˆ—åˆ«åä¸éœ€è¦è¯´æ˜æ¥æº</li>
  <li>ä¸‹é¢çš„ä¾‹å­ä¸­æœ‰ä¸‰ä¸ªå­æŸ¥è¯¢ï¼Œç¬¬ä¸€ä¸ªä¸ºç›¸å…³å­æŸ¥è¯¢ï¼Œè¡¨ç¤ºæŸé¡¾å®¢è®¢å•æ€»é‡ï¼Œç¬¬äºŒä¸ªä¸ºå­æŸ¥è¯¢ï¼Œè¡¨ç¤ºæ‰€æœ‰è®¢å•å¹³å‡å€¼ï¼Œç¬¬ä¸‰ä¸ªå¼•ç”¨åŒçº§çš„åˆ—åˆ«åï¼Œè¡¨ç¤ºå‰ä¸¤è€…çš„å·®</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> 
    <span class="n">client_id</span><span class="p">,</span>
    <span class="n">name</span><span class="p">,</span>
    <span class="p">(</span><span class="k">SELECT</span> <span class="k">SUM</span><span class="p">(</span><span class="n">invoice_total</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">invoices</span> <span class="k">WHERE</span> <span class="n">client_id</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">client_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_sales</span><span class="p">,</span>
    <span class="p">(</span><span class="k">SELECT</span> <span class="k">AVG</span><span class="p">(</span><span class="n">invoice_total</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">invoices</span><span class="p">)</span> <span class="k">AS</span> <span class="n">average</span><span class="p">,</span>
    <span class="p">(</span><span class="k">SELECT</span> <span class="n">total_sales</span> <span class="o">-</span> <span class="n">average</span><span class="p">)</span> <span class="k">AS</span> <span class="n">difference</span>   
<span class="k">FROM</span> <span class="n">clients</span> <span class="k">c</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>å­æŸ¥è¯¢ä¹Ÿå¯ç”¨äº<code class="language-plaintext highlighter-rouge">FROM</code>ä¸­</li>
  <li>å½“å­æŸ¥è¯¢å¤ªå¤æ‚æ—¶åº”ä½¿ç”¨è§†å›¾å°†å­æŸ¥è¯¢ç»“æœå‚¨å­˜èµ·æ¥ï¼Œä½¿ç”¨è§†å›¾ä½œä¸ºæ¥æºè¡¨</li>
  <li>åœ¨FROMä¸­ä½¿ç”¨å­æŸ¥è¯¢ï¼Œå³ä½¿ç”¨ â€œæ´¾ç”Ÿè¡¨â€ æ—¶ï¼Œå¿…é¡»ç»™æ´¾ç”Ÿè¡¨å–ä¸ªåˆ«å</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> 
<span class="k">FROM</span> <span class="p">(</span>
    <span class="k">SELECT</span> 
        <span class="n">client_id</span><span class="p">,</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="p">(</span><span class="k">SELECT</span> <span class="k">SUM</span><span class="p">(</span><span class="n">invoice_total</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">invoices</span> <span class="k">WHERE</span> <span class="n">client_id</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">client_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_sales</span><span class="p">,</span>
        <span class="p">(</span><span class="k">SELECT</span> <span class="k">AVG</span><span class="p">(</span><span class="n">invoice_total</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">invoices</span><span class="p">)</span> <span class="k">AS</span> <span class="n">average</span><span class="p">,</span>
        <span class="p">(</span><span class="k">SELECT</span> <span class="n">total_sales</span> <span class="o">-</span> <span class="n">average</span><span class="p">)</span> <span class="k">AS</span> <span class="n">difference</span>   
    <span class="k">FROM</span> <span class="n">clients</span> <span class="k">c</span>
<span class="p">)</span> <span class="k">AS</span> <span class="n">sales_summury</span>
<span class="k">WHERE</span> <span class="n">total_sales</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="åŸºæœ¬å‡½æ•°">åŸºæœ¬å‡½æ•°</h2>

<p>å†…ç½®çš„ç”¨æ¥å¤„ç†æ•°å€¼ã€æ–‡æœ¬ã€æ—¥æœŸç­‰çš„å‡½æ•°</p>

<ul>
  <li>æ•°å€¼å‡½æ•°</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">ROUND</span><span class="p">(</span><span class="mi">5</span><span class="p">.</span><span class="mi">7365</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1">-- å››èˆäº”å…¥</span>
<span class="k">SELECT</span> <span class="k">TRUNCATE</span><span class="p">(</span><span class="mi">5</span><span class="p">.</span><span class="mi">7365</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1">-- æˆªæ–­</span>
<span class="k">SELECT</span> <span class="n">CEILING</span><span class="p">(</span><span class="mi">5</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span>  <span class="c1">-- å¤©èŠ±æ¿å‡½æ•°ï¼Œå¤§äºç­‰äºæ­¤æ•°çš„æœ€å°æ•´æ•°</span>
<span class="k">SELECT</span> <span class="n">FLOOR</span><span class="p">(</span><span class="mi">5</span><span class="p">.</span><span class="mi">6</span><span class="p">)</span>  <span class="c1">-- åœ°æ¿å‡½æ•°ï¼Œå°äºç­‰äºæ­¤æ•°çš„æœ€å¤§æ•´æ•°</span>
<span class="k">SELECT</span> <span class="k">ABS</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span>  <span class="c1">-- ç»å¯¹å€¼</span>
<span class="k">SELECT</span> <span class="n">RAND</span><span class="p">()</span>  <span class="c1">-- éšæœºå‡½æ•°ï¼Œ0åˆ°1çš„éšæœºå€¼</span>
</code></pre></div></div>

<ul>
  <li>å­—ç¬¦ä¸²å‡½æ•°</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">LENGTH</span><span class="p">(</span><span class="s1">'sky'</span><span class="p">)</span>  <span class="c1">-- å­—ç¬¦ä¸²å­—ç¬¦ä¸ªæ•°</span>

<span class="k">SELECT</span> <span class="k">UPPER</span><span class="p">(</span><span class="s1">'sky'</span><span class="p">)</span>  <span class="c1">-- è½¬å¤§å†™</span>
<span class="k">SELECT</span> <span class="k">LOWER</span><span class="p">(</span><span class="s1">'Sky'</span><span class="p">)</span>  <span class="c1">-- è½¬å°å†™</span>

<span class="k">SELECT</span> <span class="n">LTRIM</span><span class="p">(</span><span class="s1">'  Sky'</span><span class="p">)</span>  <span class="c1">-- å»é™¤å·¦å¤šä½™ç©ºæ ¼</span>
<span class="k">SELECT</span> <span class="n">RTRIM</span><span class="p">(</span><span class="s1">'Sky  '</span><span class="p">)</span>  <span class="c1">-- å»é™¤å³å¤šä½™ç©ºæ ¼</span>
<span class="k">SELECT</span> <span class="k">TRIM</span><span class="p">(</span><span class="s1">' Sky '</span><span class="p">)</span>  <span class="c1">-- å»é™¤å¤šä½™ç©ºæ ¼</span>

<span class="k">SELECT</span> <span class="k">LEFT</span><span class="p">(</span><span class="s1">'Kindergarden'</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1">-- å–å·¦4ä¸ªå­—ç¬¦</span>
<span class="k">SELECT</span> <span class="k">RIGHT</span><span class="p">(</span><span class="s1">'Kindergarden'</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>  <span class="c1">-- å–å³6ä¸ªå­—ç¬¦</span>
<span class="k">SELECT</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="s1">'Kindergarden'</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>  <span class="c1">-- ä»ç¬¬7ä¸ªå¼€å§‹é•¿åº¦ä¸º6çš„å­ä¸²ï¼Œçœç•¥é•¿åº¦å‚æ•°åˆ™å–åˆ°æœ«ç«¯</span>

<span class="k">SELECT</span> <span class="n">LOCATE</span><span class="p">(</span><span class="s1">'gar'</span><span class="p">,</span> <span class="s1">'Kindergarden'</span><span class="p">)</span>  <span class="c1">-- å®šä½é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œæ²¡æœ‰çš„è¯è¿”å›0ï¼Œä¸åŒºåˆ†å¤§å°å†™</span>

<span class="k">SELECT</span> <span class="k">REPLACE</span><span class="p">(</span><span class="s1">'Kindergarten'</span><span class="p">,</span> <span class="s1">'garten'</span><span class="p">,</span> <span class="s1">'garden'</span><span class="p">)</span>  <span class="c1">-- æ›¿æ¢</span>

<span class="k">SELECT</span> <span class="n">CONCAT</span><span class="p">(</span><span class="n">f_name</span><span class="p">,</span> <span class="s1">' '</span><span class="p">,</span> <span class="n">l_name</span><span class="p">)</span> <span class="k">AS</span> <span class="n">f_name</span> <span class="k">FROM</span> <span class="n">customers</span>  <span class="c1">-- è¿æ¥</span>
</code></pre></div></div>

<ul>
  <li>å¤„ç†æ—¶é—´æ—¥æœŸçš„å‡½æ•°</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- å½“å‰æ—¶é—´æ—¥æœŸå¯¹è±¡</span>
<span class="k">SELECT</span> <span class="n">NOW</span><span class="p">()</span>  <span class="c1">-- 2021-08-27 08:50:46</span>
<span class="k">SELECT</span> <span class="n">CURDATE</span><span class="p">()</span>  <span class="c1">-- 2021-08-27</span>
<span class="k">SELECT</span> <span class="n">CURTIME</span><span class="p">()</span>  <span class="c1">-- 08:50:46</span>

<span class="c1">-- æå–æ—¶é—´æ—¥æœŸå¯¹è±¡ä¸­çš„å…ƒç´ </span>
<span class="k">SELECT</span> <span class="nb">YEAR</span><span class="p">(</span><span class="n">NOW</span><span class="p">())</span>  <span class="c1">-- 2021</span>

<span class="k">SELECT</span> <span class="n">DAYNAME</span><span class="p">(</span><span class="n">NOW</span><span class="p">())</span>  <span class="c1">-- Saturday</span>
<span class="k">SELECT</span> <span class="n">MONTHNAME</span><span class="p">(</span><span class="n">NOW</span><span class="p">())</span>  <span class="c1">-- September</span>
</code></pre></div></div>

<ul>
  <li>æ—¥æœŸæ ¼å¼åŒ–ï¼Œæ ¼å¼è¯´æ˜ç¬¦é‡Œï¼Œå¤§å°å†™æ˜¯ä¸åŒçš„ï¼Œè¿™æ˜¯ç›®å‰SQLé‡Œç¬¬ä¸€æ¬¡å‡ºç°å¤§å°å†™ä¸åŒçš„æƒ…å†µ</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">DATE_FORMAT</span><span class="p">(</span><span class="n">NOW</span><span class="p">(),</span> <span class="s1">'%M %d, %Y'</span><span class="p">)</span>  <span class="c1">-- September 12, 2020</span>
<span class="k">SELECT</span> <span class="n">TIME_FORMAT</span><span class="p">(</span><span class="n">NOW</span><span class="p">(),</span> <span class="s1">'%H:%i %p'</span><span class="p">)</span>  <span class="c1">-- 11:07 AM</span>
</code></pre></div></div>

<h2 id="select-è¯­å¥æ‰§è¡Œé¡ºåº">SELECT è¯­å¥æ‰§è¡Œé¡ºåº</h2>

<p>å…¶ä¸­æ¯ä¸€ä¸ªæ“ä½œéƒ½ä¼šäº§ç”Ÿä¸€å¼ è™šæ‹Ÿçš„è¡¨ï¼Œè¿™ä¸ªè™šæ‹Ÿçš„è¡¨ä½œä¸ºä¸€ä¸ªå¤„ç†çš„è¾“å…¥ï¼Œåªæ˜¯è¿™äº›è™šæ‹Ÿçš„è¡¨å¯¹ç”¨æˆ·æ¥è¯´æ˜¯é€æ˜çš„ï¼Œåªæœ‰æœ€åä¸€ä¸ªè™šæ‹Ÿçš„è¡¨æ‰ä¼šè¢«ä½œä¸ºç»“æœè¿”å›ã€‚</p>

<ol>
  <li>FORMï¼šå¯¹è¡¨è®¡ç®—ç¬›å¡å°”ç§¯ï¼Œäº§ç”Ÿè™šè¡¨VT1ã€‚</li>
  <li>ONï¼šå¯¹è™šè¡¨VT1è¿›è¡ŒONç­›é€‰ï¼Œåªæœ‰é‚£äº›ç¬¦åˆ<code class="language-plaintext highlighter-rouge">join-condition</code>çš„è¡Œæ‰ä¼šè¢«è®°å½•åœ¨è™šè¡¨VT2ä¸­ã€‚</li>
  <li>JOINï¼šå¦‚æœæŒ‡å®šäº†OUTER JOINï¼ˆæ¯”å¦‚left joinã€ right joinï¼‰ï¼Œé‚£ä¹ˆä¿ç•™è¡¨ä¸­æœªåŒ¹é…çš„è¡Œå°±ä¼šä½œä¸ºå¤–éƒ¨è¡Œæ·»åŠ åˆ°è™šæ‹Ÿè¡¨VT2ä¸­ï¼Œäº§ç”Ÿè™šæ‹Ÿè¡¨VT3, å¦‚æœfromå­å¥ä¸­åŒ…å«ä¸¤ä¸ªä»¥ä¸Šçš„è¡¨çš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šå¯¹ä¸Šä¸€ä¸ªjoinè¿æ¥äº§ç”Ÿçš„ç»“æœVT3å’Œä¸‹ä¸€ä¸ªè¡¨é‡å¤æ‰§è¡Œæ­¥éª¤1~3è¿™ä¸‰ä¸ªæ­¥éª¤ï¼Œä¸€ç›´åˆ°å¤„ç†å®Œæ‰€æœ‰çš„è¡¨ä¸ºæ­¢ã€‚</li>
  <li>WHEREï¼šå¯¹è™šæ‹Ÿè¡¨VT3è¿›è¡ŒWHEREæ¡ä»¶è¿‡æ»¤ã€‚åªæœ‰ç¬¦åˆ<code class="language-plaintext highlighter-rouge">where-condition</code>çš„è®°å½•æ‰ä¼šè¢«æ’å…¥åˆ°è™šæ‹Ÿè¡¨VT4ä¸­ã€‚</li>
  <li>GROUP BYï¼šæ ¹æ®group byå­å¥ä¸­çš„åˆ—ï¼Œå¯¹VT4ä¸­çš„è®°å½•è¿›è¡Œåˆ†ç»„æ“ä½œï¼Œäº§ç”ŸVT5ã€‚</li>
  <li>HAVINGï¼šå¯¹è™šæ‹Ÿè¡¨VT5åº”ç”¨havingè¿‡æ»¤ï¼Œåªæœ‰ç¬¦åˆ<code class="language-plaintext highlighter-rouge">having-condition</code>çš„è®°å½•æ‰ä¼šè¢«æ’å…¥åˆ°è™šæ‹Ÿè¡¨VT6ä¸­ã€‚</li>
  <li>SELECTï¼šæ‰§è¡Œselectæ“ä½œï¼Œé€‰æ‹©æŒ‡å®šçš„åˆ—ï¼Œæ’å…¥åˆ°è™šæ‹Ÿè¡¨VT7ä¸­ã€‚</li>
  <li>DISTINCTï¼šå¯¹VT7ä¸­çš„è®°å½•è¿›è¡Œå»é‡ã€‚äº§ç”Ÿè™šæ‹Ÿè¡¨VT8ã€‚</li>
  <li>ORDER BY: å°†è™šæ‹Ÿè¡¨VT8ä¸­çš„è®°å½•æŒ‰ç…§<order_by_list>è¿›è¡Œæ’åºæ“ä½œï¼Œäº§ç”Ÿè™šæ‹Ÿè¡¨VT9ã€‚</order_by_list></li>
  <li>LIMITï¼šå–å‡ºæŒ‡å®šè¡Œçš„è®°å½•ï¼Œäº§ç”Ÿè™šæ‹Ÿè¡¨VT10,å¹¶å°†ç»“æœè¿”å›ã€‚</li>
</ol>

<h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2>

<p><a href="https://www.bilibili.com/video/BV1UE41147KC?p=34">ä¼Ÿå¤§çš„æµ·ä¼¦å›.SQLè¿›é˜¶æ•™ç¨‹</a></p>

<p><a href="https://zhuanlan.zhihu.com/p/222865842">ASC2050.Moshå®Œå…¨æŒæ¡SQLç¬”è®°</a></p>

:ET